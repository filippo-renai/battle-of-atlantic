<!doctype html>
<html lang="en">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap CSS -->
    <style>
        span.elem { color:#FF0000;font-weight:bold;font-family:Tahoma;font-size:20 }
    </style>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

    <title>BOA</title>
</head>

<body style="background-color:rgb(6, 71, 87);">
    <!-- Title -->
    <div class="container text-center">
        <div class="row">
            <div class="col">
            </div>
            <div class="col-6">
                <h1 style="color:#576ee1">
                    <font face="Courier New, Courier, mono"> BATTLE OF ATLANTIC </font>
                </h1>
            </div>
            <div class="col">
                <br>
                <button type="button" class="btn btn-outline-info btn-sm" onclick="sound();">♫</button>
            </div>
        </div>
    </div>
    <br><br>
    <div class="container">
        <audio id="game" src="game.mp3" preload="auto" loop></audio>
        <audio id="water" src="water.mp3" preload="auto"></audio>
        <audio id="win" src="win.mp3" preload="auto"></audio>
        <audio id="fail" src="fail.mp3" preload="auto"></audio>
        <div class="row">
            <div class="col-8">
                <p class="lh-1" style="color:#ffffff">
                    <font face="Courier New, Courier, mono">
                        SILURISTA: <br>
                        "CAPITANO LE RICORDO CHE I NOSTRI MISSILI POSSONO COLPIRE SOLO LA SEGUENTE GRIGLIA:"<br><br>
                    </font>
                </p>
                <p class="lh-1" style="color:#e80f0f">
                    <font face="Courier New, Courier, mono">
                        ULTIMO RIVELAMENTO (((•)))
                    </font>
                </p>
                <div class="container">
                    <div class="row">
                            
                          <div class="col">
                            <p  id="griglia" style="color:#b7bee3">

                            </p>
                          </div> 
                    </div>
                </div>


                <br>


            </div>
            <div class="col-4 text-center">

                <p class="text-center" style="color:#ffffff">
                    <font face="Courier New, Courier, mono">CORDINATA:</font>
                </p>
                <input type="email" class="form-control" id="x" placeholder="1">
                <br><br>
                <button type="button" class="btn btn-outline-danger btn-lg" onclick="game();">Fuoco</button>
            </div>
        </div>
    </div>

    <br><br><br>
    <!-- Info bottom -->
    <div class="container text-center">
        <div class="row">
            <div class="col">
            </div>
            <div class="col-8">
                <a href="index.html">
                    <button type="button" class="btn btn-outline-info btn-lg">Home</button>
                </a>
            </div>
            <div class="col">
            </div>
        </div>
    </div>
    <br>

    <!-- Footer -->
    <footer class="text-center text-lg-start bg-light text-muted">
        <div class="text-center p-4" style="background-color: rgb(6, 71, 87);">
            <p style="color:#ffffff">
                <font face="Courier New, Courier, mono">
                    Code by Filippo Renai: <a class="text-reset fw-bold"
                        href="https://github.com/filippo-renai">Github</a>
                </font>
            </p>
        </div>
    </footer>


    <!-- Option 1: Bootstrap Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
        crossorigin="anonymous"></script>
    <script>
        let spari = 0;
        let suono = true;
        let fine = false;
        let nemico = Math.floor(Math.random() * (9 - 1) + 1);

        async function game() {
            if (document.getElementById("x").value == "") {
                window.alert("You have to enter the cordinate!");
                clean();
            }
            else if (isNaN(document.getElementById("x").value)) {
                window.alert("You must enter a number!");
                clean();
            }
            else if (document.getElementById("x").value < 1 || document.getElementById("x").value > 9) {

                window.alert("You must enter a number between 1 to 5!");
                clean();
            }
            else {
                let bomba = document.getElementById("x").value;
                cleanNormale();
                spari++;

                if (spari == 1){
                    if(suono)
                        document.getElementById("game").play();
                    window.alert("Vedetta:\nColpo di avvertimento effettuato!\nL'u-boot non da segni di resa");
                }
                    // inizio della partita
                else{ 

                    // 1
                    if(nemico== 1){
                        let movimento = Math.floor(Math.random() * (3 - 1) + 1);
                        if(movimento == 1)
                            nemico = 2
                        if(movimento == 2)
                            nemico = 4
                    }

                    // 2 
                    else if(nemico== 2){
                        let movimento = Math.floor(Math.random() * (4 - 1) + 1);
                        if(movimento == 1)
                            nemico = 1
                        if(movimento == 2)
                            nemico = 5
                        if(movimento == 3)
                            nemico = 3
                    }

                    // 3
                    else if(nemico== 3){
                        let movimento = Math.floor(Math.random() * (3 - 1) + 1);
                        if(movimento == 1)
                            nemico = 2
                        if(movimento == 2)
                            nemico = 6
                    }

                    // 4 
                    else if(nemico== 4){
                        let movimento = Math.floor(Math.random() * (4 - 1) + 1);
                        if(movimento == 1)
                            nemico = 1
                        if(movimento == 2)
                            nemico = 5
                        if(movimento == 3)
                            nemico = 7
                    }

                    // 5
                    else if(nemico== 5){
                        let movimento = Math.floor(Math.random() * (5 - 1) + 1);
                        if(movimento == 1)
                            nemico = 2
                        if(movimento == 2)
                            nemico = 4
                        if(movimento == 3)
                            nemico = 6
                        if(movimento == 4)
                            nemico = 8
                    }

                    // 6
                    else if(nemico== 6){
                        let movimento = Math.floor(Math.random() * (4 - 1) + 1);
                        if(movimento == 1)
                            nemico = 3
                        if(movimento == 2)
                            nemico = 5
                        if(movimento == 3)
                            nemico = 9
                    }

                    // 7 
                    else if(nemico== 7){
                        let movimento = Math.floor(Math.random() * (3 - 1) + 1);
                        if(movimento == 1)
                            nemico = 4
                        if(movimento == 2)
                            nemico = 8
                    }

                    // 8 
                    else if(nemico== 8){
                        let movimento = Math.floor(Math.random() * (4 - 1) + 1);
                        if(movimento == 1)
                            nemico = 5
                        if(movimento == 2)
                            nemico = 7
                        if(movimento == 3)
                            nemico = 9
                    }

                    // 9 
                    else if(nemico==9){
                        let movimento = Math.floor(Math.random() * (3 - 1) + 1);
                        if(movimento == 1)
                            nemico = 6
                        if(movimento == 2)
                            nemico = 8
                    }

                    // nostro colpo lo ha affondato
                    if (bomba == nemico) {
                        fine = true;
                        document.getElementById("win").play();
                        window.alert("Vedetta:\nComandante il sottomarino è in fiamme, siamo salvi!");
                        //window.location.href = "index.html";
                    }


                    // dopo 4 colpi, il siluro puo' colpire vedere se ci ha colpito
                    if (spari > 4 && spari < 8 && Math.floor(Math.random() * (5 - 1) + 1) == 3) {
                        fine = true;
                        document.getElementById("fail").play();
                        window.alert("Boooomm!!\nVedetta:\n....\n");
                        //window.location.href = "index.html";
                    }
                    // diminuisco le propabilità
                    if (spari >= 8  && spari < 10 && Math.floor(Math.random() * (3 - 1) + 1) == 2) {
                        fine = true;
                        document.getElementById("fail").play();
                        window.alert("Boooomm!!\nVedetta:\n....\n");
                        //window.location.href = "index.html";
                    }

                    if(spari == 10){
                        fine = true;
                        document.getElementById("fail").play();
                        window.alert("Boooomm!!\nVedetta:\n....\n");
                        //window.location.href = "index.html";
                    }

                    if (spari == 3 && fine == false){
                 //       if(suono)
                            document.getElementById("water").play();
                        window.alert("Vedetta:\n Comandante il bersaglio ha mancato l'obiettivo!\nDa questo momento siamo raggiungibili dai loro missili");
                    }
                    else if (fine == false){
                   //     if(suono)
                            document.getElementById("water").play();
                        window.alert("Vedetta:\n Comandante il bersaglio ha mancato l'obiettivo!");
                    }
                }

            }
        }

    
        async function cleanNormale() {
            document.getElementById("x").value = "";
            document.getElementById("griglia").innerHTML = grig(nemico);
        }

        async function clean() {
            document.getElementById("x").value = "";
        }

        async function sound() {
            if(suono){
                suono = false;
                document.getElementById("game").pause();
            }
            else{
                suono = true;
                document.getElementById("game").play();
            }
        }

        function grig(number) {
            if(number == 1){
                return   `<font face="Courier New, Courier, mono">
                                    | <span class="elem">1</span> | 2 | 3 | <br>
                                    | 4 | 5 | 6 | <br>
                                    | 7 | 8 | 9 | <br>
                                </font>`;
            }
            else if(number == 2){
                return   `<font face="Courier New, Courier, mono">
                                    | 1 | <span class="elem">2</span> | 3 | <br>
                                    | 4 | 5 | 6 | <br>
                                    | 7 | 8 | 9 | <br>
                                </font>`;
            }
            else if(number == 3){
                return   `<font face="Courier New, Courier, mono">
                                    | 1 | 2 | <span class="elem">3</span> | <br>
                                    | 4 | 5 | 6 | <br>
                                    | 7 | 8 | 9 | <br>
                                </font>`;
            }
            else if(number == 4){
                return   `<font face="Courier New, Courier, mono">
                                    | 1 | 2 | 3 | <br>
                                    | <span class="elem">4</span> | 5 | 6 | <br>
                                    | 7 | 8 | 9 | <br>
                                </font>`;
            }
            else if(number == 5){
                return   `<font face="Courier New, Courier, mono">
                                    | 1 | 2 | 3 | <br>
                                    | 4 | <span class="elem">5</span> | 6 | <br>
                                    | 7 | 8 | 9 | <br>
                                </font>`;
            }
            else if(number == 6){
                return   `<font face="Courier New, Courier, mono">
                                    | 1 | 2 | 3 | <br>
                                    | 4 | 5 | <span class="elem">6</span> | <br>
                                    | 7 | 8 | 9 | <br>
                                </font>`;
            }
            else if(number == 7){
                return   `<font face="Courier New, Courier, mono">
                                    | 1 | 2 | 3 | <br>
                                    | 4 | 5 | 6 | <br>
                                    | <span class="elem">7</span> | 8 | 9 | <br>
                                </font>`;
            }
            else if(number == 8){
                return   `<font face="Courier New, Courier, mono">
                                    | 1 | 2 | 3 | <br>
                                    | 4 | 5 | 6 | <br>
                                    | 7 | <span class="elem">8</span> | 9 | <br>
                                </font>`;
            }
            else if(number == 9){
                return   `<font face="Courier New, Courier, mono">
                                    | 1 | 2 | 3 | <br>
                                    | 4 | 5 | 6 | <br>
                                    | 7 | 8 | <span class="elem">9</span> | <br>
                                </font>`;
            }
        }


    </script>

</body>

</html>